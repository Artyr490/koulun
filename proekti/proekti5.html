<!doctype html>
<html lang="fi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Muistipeli — Kuvilla</title>
  <style>
    :root{
      --bg:#0f172a;
      --card-size:100px;
      --gap:10px;
      color-scheme: dark;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    body{
      margin:0;
      background:#0b1220;
      color:#e6eef8;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:18px;
      padding:18px;
    }
    header{
      width:100%;
      max-width:900px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:10px 0;
    }
    nav button{background:#1e293b;color:white;border:none;padding:8px 14px;margin:0 5px;border-radius:6px;cursor:pointer}
    nav button.active{background:#2563eb}
    main{width:100%;max-width:900px;}
    section{padding:20px;background:#1e293b;border-radius:12px;box-shadow:0 0 10px rgba(0,0,0,0.3)}
    h1{margin-top:0}
    select,button{padding:8px 12px;border-radius:6px;border:none;cursor:pointer}
    .board{display:grid;gap:var(--gap);justify-content:center;margin-top:20px}
    .card{width:var(--card-size);height:var(--card-size);perspective:1000px;cursor:pointer;position:relative}
    .inner{position:absolute;inset:0;transform-style:preserve-3d;transition:transform 0.4s;}
    .card.flipped .inner{transform:rotateY(180deg)}
    .face{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;border-radius:8px;backface-visibility:hidden;overflow:hidden}
    .front{transform:rotateY(180deg);background:#0f172a;}
    .front img{width:100%;height:100%;object-fit:cover}
    .back{background:#2563eb;}
    .disabled{opacity:0.5;pointer-events:none}
    .stats{margin-top:10px}
    .modal{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#1e293b;padding:20px;border-radius:10px;box-shadow:0 0 15px rgba(0,0,0,0.6)}
    .modal.show{display:block}
  </style>
</head>
<body>
  <header>
    
    <h1>Muistipeli</h1>
    <nav>
      <button class="nav-btn active" data-target="home">Etusivu</button>
      <button class="nav-btn" data-target="game">Peli</button>
    </nav>
  </header>
  <main>
    <section id="home" class="page">
      <h2>Tervetuloa muistipeliin!</h2>
      <p>Valitse pelityyppi ja etsi kaikki parit mahdollisimman nopeasti.</p>
      <ol>
        <li>Siirry Peli-sivulle</li>
        <li>Valitse pelityyppi (4x4, 4x6, 6x6)</li>
        <li>Klikkaa Aloita peli</li>
      </ol>
    </section>
    <section id="game" class="page" style="display:none">
      <div>
        <label>Pelityyppi:</label>
        <select id="size">
          <option value="4x4">4x4</option>
          <option value="4x6">4x6</option>
          <option value="6x6">6x6</option>
        </select>
        <button id="start">Aloita peli</button>
        <button id="reset">Nollaa</button>
      </div>
      <div class="stats">
        Napautukset: <span id="moves">0</span> | Aika: <span id="timer">0</span>s | Parit: <span id="found">0</span>/<span id="totalPairs">8</span>
      </div>
      <div class="board" id="board"></div>
    </section>
  </main>
  <div class="modal" id="modal">
    <p id="modal-text"></p>
    <button id="modal-restart">Pelaa uudelleen</button>
    <button id="modal-home">Etusivulle</button>
  </div>
  <script>
    const navBtns=document.querySelectorAll('.nav-btn');
    const pages=document.querySelectorAll('.page');
    const board=document.getElementById('board');
    const sizeSel=document.getElementById('size');
    const startBtn=document.getElementById('start');
    const resetBtn=document.getElementById('reset');
    const movesEl=document.getElementById('moves');
    const timerEl=document.getElementById('timer');
    const foundEl=document.getElementById('found');
    const totalPairsEl=document.getElementById('totalPairs');
    const modal=document.getElementById('modal');
    const modalText=document.getElementById('modal-text');
    const modalRestart=document.getElementById('modal-restart');
    const modalHome=document.getElementById('modal-home');

    let moves=0,found=0,totalPairs=0,timer=0,timerId=null,rows=4,cols=4,lock=false,first=null,second=null,timerRunning=false;
    const imageCount=20; // kuvia 1–20 

    navBtns.forEach(btn=>btn.addEventListener('click',()=>{
      navBtns.forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      pages.forEach(p=>p.style.display=p.id===btn.dataset.target?'block':'none');
    }));

    startBtn.onclick=startGame;
    resetBtn.onclick=()=>startGame();

    modalRestart.onclick=()=>{hideModal();startGame();};
    modalHome.onclick=()=>{hideModal();showPage('home');};

    function showPage(id){pages.forEach(p=>p.style.display=p.id===id?'block':'none');}

    function startGame(){
      const val=sizeSel.value.split('x');rows=parseInt(val[0]);cols=parseInt(val[1]);
      totalPairs=(rows*cols)/2;totalPairsEl.textContent=totalPairs;
      moves=0;found=0;movesEl.textContent=moves;foundEl.textContent=found;
      timer=0;timerEl.textContent=timer;stopTimer();timerRunning=false;
      lock=false;first=null;second=null;
      const used=shuffle([...Array(imageCount).keys()].map(i=>i+1)).slice(0,totalPairs);
      const pairList=shuffle([...used,...used]);
      board.innerHTML='';
      board.style.gridTemplateColumns=`repeat(${cols}, var(--card-size))`;
      pairList.forEach(id=>board.appendChild(createCard(id)));
    }

    function createCard(id){
      const card=document.createElement('div');card.className='card';card.dataset.id=id;
      card.innerHTML=`<div class="inner"><div class="face back"></div><div class="face front"><img src="kuvat/${id}.png" alt="kuva"></div></div>`;
      card.addEventListener('click',()=>onCardClick(card));
      return card;
    }

    function onCardClick(card){
      if(lock||card.classList.contains('flipped'))return;
      if(!timerRunning){startTimer();}
      card.classList.add('flipped');moves++;movesEl.textContent=moves;
      if(!first){first=card;return;}
      second=card;
      if(first.dataset.id===second.dataset.id){
        first.classList.add('disabled');second.classList.add('disabled');
        first=null;second=null;found++;foundEl.textContent=found;if(found===totalPairs)win();
      }else{
        lock=true;setTimeout(()=>{first.classList.remove('flipped');second.classList.remove('flipped');first=null;second=null;lock=false;},800);
      }
    }

    function win(){stopTimer();modalText.textContent=`Voitit! Napautuksia: ${moves}, aika: ${timer}s.`;showModal();}

    function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;}
    function startTimer(){timerRunning=true;timerId=setInterval(()=>{timer++;timerEl.textContent=timer;},1000);}
    function stopTimer(){timerRunning=false;if(timerId)clearInterval(timerId);timerId=null;}
    function showModal(){modal.classList.add('show');}
    function hideModal(){modal.classList.remove('show');}

    startGame();
  </script>
</body>
</html>
